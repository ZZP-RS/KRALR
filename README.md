# KRALR

This is the code for the paper:
>Zhipeng Zhang, et al. Unearthing undiscovered interests: knowledge enhanced representation aggregation for long-tail recommendation[C]. Proceedings of the 10th International Conference on Integrated Uncertainty in Knowledge Modelling and Decision Making(IUKM), pp.91-103, Kanazawa, Japan, November 2-4, 2023. https://doi.org/10.1007/978-3-031-46781-3_9.
>
Also for the speical issue of IUKM2023 in Annals of Operations Research:
>Zhipeng Zhang, et al. KRALR: knowledge enhanced representation aggregation for long-tail recommendation[J]. Annals of Operations Research, Under Review.


## 1. Environment Requirement
```
The code has been tested running under Python 3.7.10. The required packages are as follows:
* torch == 1.8.0
* numpy == 1.23.5
* pandas == 1.5.3
* scipy == 1.10.1
* tqdm == 4.65.0
* scikit-learn == 1.2.2
```

## 2. KRALR operation steps
```
1. run Neighbors_Sample.py to generate Long-tail Neighbors
2. run doCooccur.py to construct Co-occurrence graph and merge Co-occurrence graph and KG
3. Run code 'python main_KRALR.py' to start KRALR
```

## 3. Ablation study
### 3.1 Base
1. Replace the training set from trainCKG.txt to train.txt (set on line 21 of the data_loader.py),and trainCKG.txt is generated by Neighbors_ Sample.py, please do not replace data_ Line 22 of the loader.py file, which is used to calculate evaluation metrics
2. Replace the knowledge graph file from kg_ Replace final2.txt to kg_ Final.txt(set on line 24 of the data_loader.py), and final2.txt is generated by doCooccur.py
3. Run code 'python main_KRALR.py' to start Base

### 3.2 KRALR-URA
1. Replace the knowledge graph file from kg_ Replace final2.txt to kg_ Final.txt(set on line 24 of the data_loader.py)
2. Run code 'python main_KRALR.py' to start KRALR-URA

### 3.3 KRALR-IRA
1. Replace the training set from trainCKG.txt to train.txt (set on line 21 of the data_loader.py)
2. Run code 'python main_KRALR.py' to start KRALR-IRA

## 4. datasets
We provided three datasets to validate KRALR: last-fm, movielens-1m, and amazon-book. 

The following table shows the interaction information of three datasets:

|  Interaction Datasets   |    last-fm     |  movielens-1m  | amazon-book|
|  :---------------:   |:--------------:|:-------:|:-------:|
|       #users        |     23566      |  6040   |  70679  |
|       #items        |     48123      |  3655   |  24915  |
|    #interactions    |    3034796     | 997579  |  847733 |

The following table shows the KG information of three datasets:

| Knowledge Graph |   Freebase(last-fm)   |  Freebase(movielens-1m)  | Freebase(amazon-book)  | 
|:---------------:|          :-----------:         |     :-------:     |:-------:     |
|   #entities    |              58266            |       398505      |  88572  |
|   #relations   |                 9              |         57        |  39   |
|    #triples    |              464567            |       3396595     |  2557746 |



