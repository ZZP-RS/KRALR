# KRALR

This is the code for the paper:
>Zhipeng Zhang, Yuhang Zhang, Tianyang Hao, Zuoqing Li, Yao Zhang, Masahiro Inuiguchi. Unearthing undiscovered interests: knowledge enhanced representation aggregation for long-tail recommendation[C]. Proceedings of the 10th International Conference on Integrated Uncertainty in Knowledge Modelling and Decision Making(IUKM), pp.91-103, Kanazawa, Japan, November 2-4, 2023. https://doi.org/10.1007/978-3-031-46781-3_9


## 1. Introduction
KRALR discovers users' long tail interests through random walks and enhances the quality of long tail items by constructing co-occurrence graphs

If you want to use codes and datasets in your research, please contact the paper authors and cite the following paper as the reference:
```
@inproceedings{KRALR,
  author    = {Zhipeng Zhang and
               Yuhang Zhang and
               Tianyang Hao and
               Zuoqing Li and
               Yao Zhang and
               Masahiro Inuiguchi
  title     = {Unearthing Undiscovered Interests: Knowledge Enhanced Representation Aggregation for Long-Tail Recommendation},
  booktitle = {{IUKM2023}},
  pages     = {91-103},
  year      = {2023}
}
```


## 2. Environment Requirement
```
The code has been tested running under Python 3.7.10. The required packages are as follows:
* torch == 1.8.0
* numpy == 1.23.5
* pandas == 1.5.3
* scipy == 1.10.1
* tqdm == 4.65.0
* scikit-learn == 1.2.2
```

## 3. KRALR operation steps
```
1. run Neighbors_Sample.py to generate Long-tail Neighbors
2. run doCooccur.py to construct Co-occurrence graph and merge Co-occurrence graph and KG
3. Run code 'python main_KRALR.py' to start KRALR
```

## 4. Ablation study
### 4.1 Base
1. Replace the training set from trainCKG.txt to train.txt (set on line 21 of the data_loader.py),and trainCKG.txt is generated by Neighbors_ Sample.py, please do not replace data_ Line 22 of the loader.py file, which is used to calculate evaluation metrics
2. Replace the knowledge graph file from kg_ Replace final2.txt to kg_ Final.txt(set on line 24 of the data_loader.py), and final2.txt is generated by doCooccur.py
3. Run code 'python main_KRALR.py' to start Base

### 4.2 KRALR-URA
1. Replace the knowledge graph file from kg_ Replace final2.txt to kg_ Final.txt(set on line 24 of the data_loader.py)
2. Run code 'python main_KRALR.py' to start KRALR-URA

### 4.3 KRALR-IRA
1. Replace the training set from trainCKG.txt to train.txt (set on line 21 of the data_loader.py)
2. Run code 'python main_KRALR.py' to start KRALR-IRA



## 5. datasets
We provided two datasets to validate KRALR: last-fm and ml-1m,  The following table shows the interaction information of last-fm  and ml-1m :

|  Interactions   |    last-fm     |  ml-1m  |
|:---------------:|:--------------:|:-------:|
|     n_users     |     23566      |  6040   |
|     n_items     |     48123      |  3655   |
| n_interactions  |    3034796     | 997579  |

 Besides the user-item interactions, we need to construct item knowledge for each dataset. For last-fm, we mapped items to Microsoft Satori entities. For ml-1m, we employed Freebase to map movies in MovieLens1M to construct KG.
The following table shows the KG information of last-fm  and ml-1m :

| Knowledge Graph |   last-fm   |  ml-1m  |
|:---------------:|:-----------:|:-------:|
|   n_entities    |   106389    | 398505  |
|   n_relations   |      9      |   57    |
|    n_triples    |   464567    | 3396595 |



